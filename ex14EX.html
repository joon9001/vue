<!--ë·° íŒŒì¼ì—ì„œ jpa DB ì§ì› í…Œì´ë¸” ì •ë³´ë¥¼ ajaxë¡œ ì½ì–´ì˜¬ ìˆ˜ ìˆëŠ”ì§€ ì—°ìŠµí•˜ëŠ” ë¬¸ì œ
ì´í´ë¦½ìŠ¤ì˜ wDazz6SprVueTest íŒŒì¼ê³¼ ì—°ë™, ë‹¤ì •ë‹˜ í’€ì´-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vueEx/ex14EX.html</title>
    <script src="https://unpkg.com/vue@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <style>
      body {
        text-align: center;
      }
      table {
        width: 70%;
        padding-left: 30%;
      }
      th {
        background-color: deeppink;
        color: white;
        padding: 4px;
      }
      button {
        border-radius: 10px;
        padding: 5px;
        background-color: deeppink;
        border: none;
        color: white;
      }
    </style>
  </head>
  <body>
    <h2>ğŸ¥ ì§ì› ê²€ìƒ‰</h2>
    <div id="app">
      <input type="text" placeholder="ì§ê¸‰ ê²€ìƒ‰" v-model="jik" />&ensp;
      <!--ì‚¬ìš©ìê°€ ì…ë ¥ í•„ë“œì— ì§ê¸‰ì„ ì…ë ¥í•˜ë©´ v-modelì„ í†µí•´ this.jikì— ê°’ì´ ì €ì¥-->
      <button @click="inputCheck">í™•ì¸</button>
      <table v-if="jikwon.length > 0">
        <thead>
          <tr>
            <th>ì‚¬ë²ˆ</th>
            <th>ì´ë¦„</th>
            <th>ë¶€ì„œëª…</th>
            <th>ì§ê¸‰</th>
            <th>ì—°ë´‰</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="(j, index) in jikwon" :key="index">
            <td>{{j.no}}</td>
            <td>{{j.name}}</td>
            <td>{{j.bname}}</td>
            <td>{{j.jik}}</td>
            <td>{{j.pay}}</td>
          </tr>
          <tr>
            <td colspan="2">ì¸ì›ìˆ˜</td>
            <td colspan="3">{{jikwon.length}}</td>
          </tr>
          <tr>
            <td colspan="2">ì—°ë´‰ í‰ê· </td>
            <td colspan="3">{{avgPay}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <script>
      const { createApp } = Vue;
      createApp({
        data() {
          return {
            jikwon: [],
            jik: "",
            avgPay: 0,
          };
        },
        methods: {
          inputCheck() {
            if (this.jik === "") {
              alert("ì§ê¸‰ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”");
              return;
            }
            this.jikwonFunc();
          },
          jikwonFunc() {
            axios
              .get("http://localhost/jikwon/" + this.jik)
              .then((data) => {//ì—¬ê¸°ì„œ dataëŠ” í†µì‹ ì— ì„±ê³µ ì‹œ ë°›ëŠ” ë³€ìˆ˜ëª…ì´ë©° ì›ë˜ëŠ”
                //responseë¡œ ë°›ì•„ì˜¤ë‚˜ ì„ì˜ë¡œ ë³€ìˆ˜ëª…ì„ dataë¼ê³  ì„¤ì •í•´ë„ ëœë‹¤.
                this.jikwon = data.data;
//reduce ë©”ì„œë“œëŠ” ë‘ ê°€ì§€ ì¸ìˆ˜(ëˆ„ì‚°ê¸°(accumulator), í˜„ì¬ ê°’(current value))ë¥¼ ë°›ì•„ 
//í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ì¤„ì´ëŠ” ì—­í• , ì•„ë˜ ì½”ë“œì—ì„œ reduceëŠ” ì§ì›ë“¤ì˜ ì—°ë´‰ í•©ê³„ë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì‚¬ìš©
                let sumPay = this.jikwon.reduce((result, jd) => {
                  return (result += parseInt(jd.pay));
                }, 0);
                this.avgPay = Number(
                  (sumPay / this.jikwon.length).toFixed(1) 
    //.toFixed(1)ì€ ì†Œìˆ˜ì  ì²«ì§¸ ìë¦¬ê¹Œì§€ ë°˜ì˜¬ë¦¼
                ).toLocaleString(); 
//.toLocaleString()ì€ ìˆ«ìë¥¼ "1,000"ê³¼ ê°™ì´ ,ë¥¼ ì“¸ ìˆ˜ ìˆëŠ” ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ì‚¬ìš©
              })
              .catch((err) => {
                console.log("ERROR : ", err);
              });
          },
        },
      }).mount("#app");
    </script>
  </body>
</html>
